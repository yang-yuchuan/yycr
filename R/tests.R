test_coefdiff_welcht = function(data, fml, x, split_var, id_var = NULL, cluster = F, boot = 500) {    split_var <- sym(split_var)

  if (cluster & is.null(id_var)) stop("Set id variable.")    # calculating s.e.  set.seed(11101227)  data %>%     {if (cluster) {      nest(., .by = id_var) %>%         rsample::bootstraps(boot) %>%         mutate(dt = map(splits, . %>% as_tibble() %>% unnest(data)))    } else {      rsample::bootstraps(., boot) %>%         mutate(dt = map(splits, . %>% as_tibble()))    }} %>%    mutate(      beta0 = map_dbl(        dt,         ~ filter(., !!split_var == 0) %>%           feols(fml) %>%          broom::tidy() %>%          filter(term == x) %>%          pull(estimate)      ),      beta1 = map_dbl(        dt,        ~ filter(., !!split_var == 1) %>%          feols(fml) %>%          broom::tidy() %>%          filter(term == x) %>%          pull(estimate)      )    ) %>%     select(beta0, beta1) %>%     summarise(      diff = mean(beta1) - mean(beta0),      se = sqrt(sd(beta0) ^ 2 / boot + sd(beta1) ^ 2 / boot),      dof = (var(beta0) + var(beta1)) ^ 2 / (var(beta0) ^ 2 + var(beta1) ^ 2) * (boot - 1),      t90 = qt(0.95, dof), t95 = qt(0.975, dof), t99 = qt(0.995, dof), t999 = qt(0.9995, dof),      t = abs(diff / se)    )}